{% extends "base/BaseAdmin.html" %} {% block Titulo %}Mapa Interactivo - Google
Maps{% endblock Titulo %} {% block body %}
<style>
  html,
  body,
  #map {
    height: 100%;
    width: auto;
    display: flex;
    flex-direction: column;
    margin: 0;
    padding: 0 !important;
  }

  .container {
    height: 100%;
    display: flex;
    flex-direction: column;
    padding: 0 !important;
  }

  .map-header {
    background: linear-gradient(135deg, #2c3e50, #4a6491);
    color: white;
    padding: 15px 25px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    z-index: 1001;
    gap: 15px;
    flex-wrap: wrap;
  }

  .map-header h1 {
    margin: 0;
    font-size: 1.6rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .search-box-header {
    flex-grow: 1;
    min-width: 250px;
    padding: 10px 15px;
    border: none;
    border-radius: 25px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    font-size: 1rem;
    outline: none;
  }

  .map-controls {
    display: flex;
    gap: 12px;
  }

  .map-controls button {
    background-color: #3498db;
    color: white;
    border: none;
    padding: 10px 18px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.95rem;
    display: flex;
    align-items: center;
    gap: 8px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    transition: all 0.3s;
  }

  .map-controls button:hover {
    background-color: #2980b9;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
  }

  #map {
    flex-grow: 1;
    width: auto;
    z-index: 1;
  }

  .info-panel {
    position: absolute;
    top: 95px;
    /* Ajustado para no solapar */
    right: 20px;
    width: 320px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    z-index: 1000;
    padding: 20px;
    display: none;
    transition: all 0.3s ease;
  }

  .info-panel.active {
    display: block;
    animation: slideIn 0.3s ease;
  }

  @keyframes slideIn {
    from {
      opacity: 0;
      transform: translateX(20px);
    }

    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  .info-panel h3 {
    margin-top: 0;
    color: #2c3e50;
    border-bottom: 2px solid #f1f1f1;
    padding-bottom: 12px;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .close-panel {
    position: absolute;
    top: 15px;
    right: 15px;
    background: none;
    border: none;
    font-size: 1.4rem;
    cursor: pointer;
    color: #7f8c8d;
    transition: color 0.3s;
  }

  .close-panel:hover {
    color: #e74c3c;
  }

  .custom-info-window {
    padding: 15px;
    max-width: 250px;
  }

  .custom-info-window h3 {
    margin-top: 0;
    color: #2c3e50;
    border-bottom: 1px solid #eee;
    padding-bottom: 8px;
  }

  .custom-info-window p {
    margin: 8px 0;
    color: #555;
  }

  .custom-info-window button {
    background-color: #3498db;
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 4px;
    cursor: pointer;
    width: 100%;
    margin-top: 10px;
    transition: background-color 0.3s;
  }

  .custom-info-window button:hover {
    background-color: #2980b9;
  }
</style>

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

<div class="container">
  <div class="map-header">
    <h1><i class="fas fa-map-marked-alt"></i> Mapa Interactivo - Nicaragua</h1>
    {# <input id="searchBox" class="search-box-header" type="text" placeholder="Buscar ubicación..."> #}
    <div class="map-controls">
      <button id="resetView"><i class="fas fa-home"></i> Vista Inicial</button>
      <button id="togglePanel">
        <i class="fas fa-info-circle"></i> Información
      </button>
      <button id="addMarker">
        <i class="fas fa-map-marker-alt"></i> Agregar Marcador
      </button>
    </div>

  </div>

  <div id="map"></div>

  <div class="info-panel" id="infoPanel">
    <button class="close-panel">&times;</button>
    <h3><i class="fas fa-info-circle"></i> Información de Ubicación</h3>
    <div id="panelContent">
      <p>Seleccione un marcador en el mapa para ver información detallada.</p>
    </div>
  </div>
</div>

<script src="{{ url_for('static', filename='js/RenderMap.js') }}"></script>
<script>
  // Función para inicializar el mapa una vez que la API esté lista
  function initializeMap() {
    const locations = {{ locations | safe
  }};
  initMap(locations);
  }

</script>

<script async defer
  src="https://maps.googleapis.com/maps/api/js?key={{ google_maps_api_key }}&libraries=places&callback=initializeMap">
  </script>

<noscript>
  <div style="
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
    ">
    <h2>Se requiere JavaScript para ver el mapa</h2>
    <p>
      Por favor, active JavaScript en su navegador para utilizar esta
      funcionalidad.
    </p>
  </div>
</noscript>

<script>
  // Aplica estilos al contenedor principal para que el mapa ocupe todo el espacio.
  document.addEventListener('DOMContentLoaded', function () {
    const mainContent = document.querySelector('.main-content');
    if (mainContent) {
      mainContent.style.display = 'flex';
      mainContent.style.flexDirection = 'column';
      mainContent.style.padding = '0';
    }
  });
</script>

{% endblock body %}